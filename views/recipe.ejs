<%- include('partials/every-other-page-header') -%>

<!-- name, image, and cooking time -->

<section class="container">
    <div>
        <h1><%= recipe.recipeName %></h1>

        <!-- button that triggers a bootstrap modal -->

        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editRecipe">
            Edit Recipe
        </button>
          
          <!-- Modal -->
          <div class="modal fade" id="editRecipe" tabindex="-1" aria-labelledby="editRecipeLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="editRecipe">Edit Recipe</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <!-- form with method override to edit all the fields of the recipe -->
                    <form action="/post/editRecipe/<%= recipe._id %>?_method=PUT" method="POST">

                        <!-- recipe name -->
                        <div class="mb-3">
                            <label for="recipeName" class="form-label"><strong>Recipe Name</strong></label>
                            <input type="text" class="form-control" id="recipeName" name="recipeName" placeholder="<%= recipe.recipeName %>">
                        </div>

                        <!-- type -->
                        <div class="form-group mb-3">
                          <label for="type" class="form-label"><strong>Type</strong></label>
                          <select class="form-select" id="type" name="type">
                            <option selected><%= recipe.type %></option> 
                            <option value="Breakfast">Breakfast</option>
                            <option value="Entrée">Entrée</option>
                            <option value="Dessert">Dessert</option>
                            <option value="Vegan">Vegan</option>
                            <option value="Vegetarian">Vegetarian</option>
                          </select>
                        </div>

                        <!-- description -->
                        <div class="mb-3">
                          <label for="description" class="form-label"><strong>Description</strong></label>
                          <textarea type="text" placeholder="<%= recipe.description %>" class="form-control" id="description" name="description" rows="10"></textarea>
                        </div>

                        <!-- prep, bake/cook, total time-->
                        <div class="row mb-3">
                          <div class="col">
                            <label for="prepTime" class="form-label"><strong>Prep Time</strong></label>
                            <input type="text" class="form-control" id="prepTime" name="prepTime" placeholder="<%= recipe.prepTime %>">
                          </div>
                          <div class="col">
                            <label for="cookTime" class="form-label"><strong>Cook Time</strong></label>
                            <input type="text" class="form-control" id="cookTime" name="cookTime" placeholder="<%= recipe.cookTime %>">
                          </div>
                          <div class="col">
                            <label for="totalTime" class="form-label"><strong>Total Time</strong></label>
                            <input type="text" class="form-control" id="totalTime" name="totalTime" placeholder="<%= recipe.totalTime %>">
                          </div>
                        </div>

                        <!-- ingredients -->
                        <div class="mb-3">
                          <label for="name" class="form-label"><strong>Ingredients</strong></label>
                          <div class="ingredientList">
                            <div class="ingredientDiv mb-1">
                              <!-- forEach loop putting each ingredient in an input -->
                              <% recipe.ingredients.forEach(function(ingredient) { %>
                                <input type="text" class="form-control" id="ingredients" name="ingredients" placeholder="<%= ingredient %>">
                              <% }); %>
                            </div>
                          </div>
                        </div>
                        <div class="mb-3">
                          <button type="button" class="btn btn-outline-primary" id="addIngredientsBtn">+ Ingredient</button>
                          <button type="button" class="btn btn-outline-primary" id="minusIngredientsBtn">- Ingredient</button>
                        </div>

                        <!-- directions -->
                        <div class="mb-3">
                          <label for="name" class="form-label"><strong>Directions</strong></label>
                          <div class="directionList">
                            <div class="directionDiv mb-1">
                              <!-- forEach loop putting each direction in an input -->
                              <% recipe.directions.forEach(function(direction) { %>
                                <input type="text" class="form-control" id="directions" name="directions" placeholder="<%= direction %>">
                              <% }); %>                                            
                            </div>
                          </div>
                        </div>
                        <div class="mb-3">
                          <button type="button" class="btn btn-outline-primary" id="addDirectionsBtn">+ Direction</button>
                          <button type="button" class="btn btn-outline-primary" id="minusDirectionsBtn">- Direction</button>
                        </div>

                        <!-- special notes -->
                        <div class="mb-3">
                          <label for="specialNotes" class="form-label"><strong>Special Notes</strong></label>
                          <textarea type="text" placeholder="<%= recipe.specialNotes %>" class="form-control" id="specialNotes" name="specialNotes"></textarea>
                        </div>

                        <!-- image -->
                        <div class="mb-3">
                          <label for="imgUpload" class="form-label"><strong>Image</strong></label>
                          <input type="file" class="form-control" id="imageUpload" name="file">
                        </div>

                        <!-- submit button -->
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>
    </div>
    <div class="container mt-3">
      <p><%= recipe.description %> </p>
      <img class='img-thumbnail' src="<%= recipe.image %>" alt="<%= recipe.name %>">
        <ul>
            <li>Prep Time: <%= recipe.prepTime %></li>
            <li>Bake/Cook: <%= recipe.cookTime %></li>
            <li>Total Time: <%= recipe.totalTime %></li>
        </ul>
    </div>
</section>

<!-- ingredients, directions, special notes -->
<section class="container">
    <!-- ingredients loop-->
    <span><strong>Ingredients</strong></span>
    <ul>
        <% for (let i = 0; i < recipe.ingredients.length; i++) { %>
            <li><%= recipe.ingredients[i] %></li>
        <% } %>
    </ul>

    <!-- directions loop -->
    <span><strong>Directions</strong></span>
    <ol>
        <% for (let i = 0; i < recipe.directions.length; i++) { %>
            <li><%= recipe.directions[i] %></li>
        <% } %>
    </ol>
    
    <!-- special notes -->
    <span><strong>Special Notes</strong></span>
    <p><%= recipe.specialNotes %></p>
</section>

<%- include('partials/every-other-page-footer') -%>
